<!doctype html><html lang=en-us><head><script data-ad-client=ca-pub-1030730506660314 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script><script id=mNCC language=javascript>medianet_width="728",medianet_height="90",medianet_crid="167545135",medianet_versionId="3111299"</script><script src="//contextual.media.net/nmedianet.js?cid=8CU62P5S3"></script><script type=text/javascript src=https://ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.min.js></script><script type=text/javascript src=https://blockchain.info/Resources/js/pay-now-button.js></script><link rel=preload href=../../lib/font-awesome/webfonts/fa-brands-400.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=../../lib/font-awesome/webfonts/fa-regular-400.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=../../lib/font-awesome/webfonts/fa-solid-900.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=../../lib/JetBrainsMono/web/woff2/JetBrainsMono-Regular.woff2 as=font type=font/woff2 crossorigin=anonymous><script type=text/javascript src=https://latest.cactus.chat/cactus.js></script><link rel=stylesheet href=https://latest.cactus.chat/style.css type=text/css><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>How to create a Windows Service in Python | The Python Corner</title><link rel=canonical href=https://mastro35.github.io/tpc/posts/2018-08-01-how-to-create-a-windows-service-in-python/><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="all,follow"><meta name=googlebot content="index,follow,snippet,archive"><meta property="og:title" content="How to create a Windows Service in Python"><meta property="og:description" content="Hi guys, today&rsquo;s post is just for the ones of you that work with the &ldquo;OS of the misoriented slashes&rdquo;: Microsoft Windows. :)
Have you ever had the need of writing a Python script that could run in background as a Windows Service? In this post, you will learn how to do it in less than 10 minutes, no jokes.
I will skip all the introduction about Windows Services, how convenient they could be, how much could be appreciated the fact that they can be run in background even when the user is logged off etc&mldr; I mean, if you can code in Python and you use Windows I bet you already know what a Windows Service is, don&rsquo;t you?"><meta property="og:type" content="article"><meta property="og:url" content="https://mastro35.github.io/tpc/posts/2018-08-01-how-to-create-a-windows-service-in-python/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2018-08-01T19:36:01+02:00"><meta property="article:modified_time" content="2018-08-01T19:36:01+02:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="How to create a Windows Service in Python"><meta name=twitter:description content="Hi guys, today&rsquo;s post is just for the ones of you that work with the &ldquo;OS of the misoriented slashes&rdquo;: Microsoft Windows. :)
Have you ever had the need of writing a Python script that could run in background as a Windows Service? In this post, you will learn how to do it in less than 10 minutes, no jokes.
I will skip all the introduction about Windows Services, how convenient they could be, how much could be appreciated the fact that they can be run in background even when the user is logged off etc&mldr; I mean, if you can code in Python and you use Windows I bet you already know what a Windows Service is, don&rsquo;t you?"><link rel=stylesheet href=https://mastro35.github.io/tpc/css/styles.c05d68261bf086a9d7713c4f8a6215a3601608e267a816a7ee58f139b3d1aae51222aae2081c8e0c6bd35e1334773b7a16283022f31f92afd93bb37e5e822e66.css integrity="sha512-wF1oJhvwhqnXcTxPimIVo2AWCOJnqBan7ljxObPRquUSIqriCByODGvTXhM0dzt6FigwIvMfkq/ZO7N+XoIuZg=="><!--[if lt IE 9]><script src=https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js></script><script src=https://oss.maxcdn.com/respond/1.4.2/respond.min.js></script><![endif]--><link rel=icon type=image/png href=https://mastro35.github.io/tpc/images/favicon.ico><script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga('create','UA-120027408-1','auto'),ga('send','pageview'))</script><script async src=https://www.google-analytics.com/analytics.js></script></head><body class="max-width mx-auto px3 ltr"><div class="content index py4"><div id=header-post><a id=menu-icon href=#><i class="fas fa-bars fa-lg"></i></a>
<a id=menu-icon-tablet href=#><i class="fas fa-bars fa-lg"></i></a>
<a id=top-icon-tablet href=# onclick="$('html, body').animate({scrollTop:0},'fast')" style=display:none aria-label="Top of Page"><i class="fas fa-chevron-up fa-lg"></i></a>
<span id=menu><span id=nav><ul><li><a href=../../>Home</a></li><li><a href=../../posts>Articles</a></li><li><a href=../../tags>Tags</a></li><li><a href=../../about>About</a></li><li><a href=../../help_us>Help Us</a></li><li><a href=https://buttondown.email/thepythoncorner>Newsletter</a></li><li><a href=https://shop.spreadshirt.com/the-python-corner>Swag Store</a></li></ul></span><br><span id=actions><ul><li><a class=icon href=https://mastro35.github.io/tpc/posts/2018-04-26-how-to-make-your-code-faster-by-using-a-cache-in-python/ aria-label=Previous><i class="fas fa-chevron-left" aria-hidden=true onmouseover="$('#i-prev').toggle()" onmouseout="$('#i-prev').toggle()"></i></a></li><li><a class=icon href=https://mastro35.github.io/tpc/posts/2019-01-13-how-to-create-a-watchdog-in-python-to-look-for-filesystem-changes/ aria-label=Next><i class="fas fa-chevron-right" aria-hidden=true onmouseover="$('#i-next').toggle()" onmouseout="$('#i-next').toggle()"></i></a></li><li><a class=icon href=# onclick="$('html, body').animate({scrollTop:0},'fast')" aria-label="Top of Page"><i class="fas fa-chevron-up" aria-hidden=true onmouseover="$('#i-top').toggle()" onmouseout="$('#i-top').toggle()"></i></a></li><li><a class=icon href=# aria-label=Share><i class="fas fa-share-alt" aria-hidden=true onmouseover="$('#i-share').toggle()" onmouseout="$('#i-share').toggle()" onclick="return $('#share').toggle(),!1"></i></a></li></ul><span id=i-prev class=info style=display:none>Previous post</span>
<span id=i-next class=info style=display:none>Next post</span>
<span id=i-top class=info style=display:none>Back to top</span>
<span id=i-share class=info style=display:none>Share post</span></span><br><div id=share style=display:none><ul><li><a class=icon href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fmastro35.github.io%2ftpc%2fposts%2f2018-08-01-how-to-create-a-windows-service-in-python%2f" aria-label=Facebook><i class="fab fa-facebook" aria-hidden=true></i></a></li><li><a class=icon href="https://twitter.com/share?url=https%3a%2f%2fmastro35.github.io%2ftpc%2fposts%2f2018-08-01-how-to-create-a-windows-service-in-python%2f&text=How%20to%20create%20a%20Windows%20Service%20in%20Python" aria-label=Twitter><i class="fab fa-twitter" aria-hidden=true></i></a></li><li><a class=icon href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fmastro35.github.io%2ftpc%2fposts%2f2018-08-01-how-to-create-a-windows-service-in-python%2f&title=How%20to%20create%20a%20Windows%20Service%20in%20Python" aria-label=Linkedin><i class="fab fa-linkedin" aria-hidden=true></i></a></li><li><a class=icon href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fmastro35.github.io%2ftpc%2fposts%2f2018-08-01-how-to-create-a-windows-service-in-python%2f&is_video=false&description=How%20to%20create%20a%20Windows%20Service%20in%20Python" aria-label=Pinterest><i class="fab fa-pinterest" aria-hidden=true></i></a></li><li><a class=icon href="mailto:?subject=How%20to%20create%20a%20Windows%20Service%20in%20Python&body=Check out this article: https%3a%2f%2fmastro35.github.io%2ftpc%2fposts%2f2018-08-01-how-to-create-a-windows-service-in-python%2f" aria-label=Email><i class="fas fa-envelope" aria-hidden=true></i></a></li><li><a class=icon href="https://getpocket.com/save?url=https%3a%2f%2fmastro35.github.io%2ftpc%2fposts%2f2018-08-01-how-to-create-a-windows-service-in-python%2f&title=How%20to%20create%20a%20Windows%20Service%20in%20Python" aria-label=Pocket><i class="fab fa-get-pocket" aria-hidden=true></i></a></li><li><a class=icon href="http://reddit.com/submit?url=https%3a%2f%2fmastro35.github.io%2ftpc%2fposts%2f2018-08-01-how-to-create-a-windows-service-in-python%2f&title=How%20to%20create%20a%20Windows%20Service%20in%20Python" aria-label=reddit><i class="fab fa-reddit" aria-hidden=true></i></a></li><li><a class=icon href="http://www.tumblr.com/share/link?url=https%3a%2f%2fmastro35.github.io%2ftpc%2fposts%2f2018-08-01-how-to-create-a-windows-service-in-python%2f&name=How%20to%20create%20a%20Windows%20Service%20in%20Python&description=Hi%20guys%2c%20today%26rsquo%3bs%20post%20is%20just%20for%20the%20ones%20of%20you%20that%20work%20with%20the%20%26ldquo%3bOS%20of%20the%20misoriented%20slashes%26rdquo%3b%3a%20Microsoft%20Windows.%20%3a%29%0aHave%20you%20ever%20had%20the%20need%20of%20writing%20a%20Python%20script%20that%20could%20run%20in%20background%20as%20a%20Windows%20Service%3f%20In%20this%20post%2c%20you%20will%20learn%20how%20to%20do%20it%20in%20less%20than%2010%20minutes%2c%20no%20jokes.%0aI%20will%20skip%20all%20the%20introduction%20about%20Windows%20Services%2c%20how%20convenient%20they%20could%20be%2c%20how%20much%20could%20be%20appreciated%20the%20fact%20that%20they%20can%20be%20run%20in%20background%20even%20when%20the%20user%20is%20logged%20off%20etc%26hellip%3b%20I%20mean%2c%20if%20you%20can%20code%20in%20Python%20and%20you%20use%20Windows%20I%20bet%20you%20already%20know%20what%20a%20Windows%20Service%20is%2c%20don%26rsquo%3bt%20you%3f" aria-label=Tumblr><i class="fab fa-tumblr" aria-hidden=true></i></a></li><li><a class=icon href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fmastro35.github.io%2ftpc%2fposts%2f2018-08-01-how-to-create-a-windows-service-in-python%2f&t=How%20to%20create%20a%20Windows%20Service%20in%20Python" aria-label="Hacker News"><i class="fab fa-hacker-news" aria-hidden=true></i></a></li></ul></div><div id=toc><nav id=TableOfContents><ul><li><a href=#if-something-goes-wrong>If something goes wrong&mldr;</a></li></ul></nav></div></span></div><article class=post itemscope itemtype=http://schema.org/BlogPosting><header><h1 class=posttitle itemprop="name headline">How to create a Windows Service in Python</h1><div class=meta><div class=postdate><time datetime="2018-08-01 19:36:01 +0200 +0200" itemprop=datePublished>2018-08-01</time></div><div class=article-read-time><i class="far fa-clock"></i>
6 minute read</div><div class=article-category><i class="fas fa-archive"></i>
<a class=category-link href=../../categories/dev>Dev</a></div><div class=article-tag><i class="fas fa-tag"></i>
<a class=tag-link href=../../tags/background rel=tag>Background</a>
,
<a class=tag-link href=../../tags/background-task rel=tag>Background Task</a>
,
<a class=tag-link href=../../tags/python rel=tag>Python</a>
,
<a class=tag-link href=../../tags/services rel=tag>Services</a>
,
<a class=tag-link href=../../tags/windows rel=tag>Windows</a></div></div></header><div class=content itemprop=articleBody><p><img src=https://imgs.xkcd.com/comics/backslashes.png alt=teaser></p><p>Hi guys, today&rsquo;s post is just for the ones of you that work with the &ldquo;OS of the misoriented slashes&rdquo;: Microsoft Windows. :)</p><p>Have you ever had the need of writing a Python script that could run in background as a Windows Service? In this post, you will learn how to do it in less than 10 minutes, no jokes.</p><p>I will skip all the introduction about Windows Services, how convenient they could be, how much could be appreciated the fact that they can be run in background even when the user is logged off etc&mldr; I mean, if you can code in Python and you use Windows I bet you already know what a Windows Service is, don&rsquo;t you?</p><p>So, first of all, let&rsquo;s start by installing the Python for Windows extensions:</p><pre><code class=language-console data-lang=console>c:test&gt; pip install pywin32
</code></pre><p>Once you have done it, let&rsquo;s write this base class, your Windows service will be a subclass of this base class.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span style=color:#f1fa8c>&#39;&#39;&#39;
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span style=color:#f1fa8c>SMWinservice
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span style=color:#f1fa8c>by Davide Mastromatteo
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span style=color:#f1fa8c>
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span style=color:#f1fa8c>Base class to create winservice in Python
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span style=color:#f1fa8c>-----------------------------------------
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span style=color:#f1fa8c>
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span style=color:#f1fa8c>Instructions:
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span style=color:#f1fa8c>
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span style=color:#f1fa8c>1. Just create a new class that inherits from this base class
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span style=color:#f1fa8c>2. Define into the new class the variables
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span style=color:#f1fa8c>   _svc_name_ = &#34;nameOfWinservice&#34;
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span style=color:#f1fa8c>   _svc_display_name_ = &#34;name of the Winservice that will be displayed in scm&#34;
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span><span style=color:#f1fa8c>   _svc_description_ = &#34;description of the Winservice that will be displayed in scm&#34;
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span><span style=color:#f1fa8c>3. Override the three main methods:
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span><span style=color:#f1fa8c>    def start(self) : if you need to do something at the service initialization.
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span><span style=color:#f1fa8c>                      A good idea is to put here the inizialization of the running condition
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">18</span><span style=color:#f1fa8c>    def stop(self)  : if you need to do something just before the service is stopped.
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">19</span><span style=color:#f1fa8c>                      A good idea is to put here the invalidation of the running condition
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">20</span><span style=color:#f1fa8c>    def main(self)  : your actual run loop. Just create a loop based on your running condition
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">21</span><span style=color:#f1fa8c>4. Define the entry point of your module calling the method &#34;parse_command_line&#34; of the new class
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">22</span><span style=color:#f1fa8c>5. Enjoy
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">23</span><span style=color:#f1fa8c>&#39;&#39;&#39;</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">24</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">25</span><span style=color:#ff79c6>import</span> socket
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">26</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">27</span><span style=color:#ff79c6>import</span> win32serviceutil
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">28</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">29</span><span style=color:#ff79c6>import</span> servicemanager
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">30</span><span style=color:#ff79c6>import</span> win32event
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">31</span><span style=color:#ff79c6>import</span> win32service
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">32</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">33</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">34</span><span style=color:#ff79c6>class</span> <span style=color:#50fa7b>SMWinservice</span>(win32serviceutil<span style=color:#ff79c6>.</span>ServiceFramework):
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">35</span>    <span style=color:#f1fa8c>&#39;&#39;&#39;Base class to create winservice in Python&#39;&#39;&#39;</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">36</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">37</span>    _svc_name_ <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#39;pythonService&#39;</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">38</span>    _svc_display_name_ <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#39;Python Service&#39;</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">39</span>    _svc_description_ <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#39;Python Service Description&#39;</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">40</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">41</span>    @classmethod
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">42</span>    <span style=color:#ff79c6>def</span> <span style=color:#50fa7b>parse_command_line</span>(cls):
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">43</span>        <span style=color:#f1fa8c>&#39;&#39;&#39;
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">44</span><span style=color:#f1fa8c>        ClassMethod to parse the command line
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">45</span><span style=color:#f1fa8c>        &#39;&#39;&#39;</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">46</span>        win32serviceutil<span style=color:#ff79c6>.</span>HandleCommandLine(cls)
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">47</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">48</span>    <span style=color:#ff79c6>def</span> __init__(self, args):
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">49</span>        <span style=color:#f1fa8c>&#39;&#39;&#39;
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">50</span><span style=color:#f1fa8c>        Constructor of the winservice
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">51</span><span style=color:#f1fa8c>        &#39;&#39;&#39;</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">52</span>        win32serviceutil<span style=color:#ff79c6>.</span>ServiceFramework<span style=color:#ff79c6>.</span>__init__(self, args)
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">53</span>        self<span style=color:#ff79c6>.</span>hWaitStop <span style=color:#ff79c6>=</span> win32event<span style=color:#ff79c6>.</span>CreateEvent(<span style=color:#ff79c6>None</span>, <span style=color:#bd93f9>0</span>, <span style=color:#bd93f9>0</span>, <span style=color:#ff79c6>None</span>)
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">54</span>        socket<span style=color:#ff79c6>.</span>setdefaulttimeout(<span style=color:#bd93f9>60</span>)
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">55</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">56</span>    <span style=color:#ff79c6>def</span> <span style=color:#50fa7b>SvcStop</span>(self):
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">57</span>        <span style=color:#f1fa8c>&#39;&#39;&#39;
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">58</span><span style=color:#f1fa8c>        Called when the service is asked to stop
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">59</span><span style=color:#f1fa8c>        &#39;&#39;&#39;</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">60</span>        self<span style=color:#ff79c6>.</span>stop()
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">61</span>        self<span style=color:#ff79c6>.</span>ReportServiceStatus(win32service<span style=color:#ff79c6>.</span>SERVICE_STOP_PENDING)
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">62</span>        win32event<span style=color:#ff79c6>.</span>SetEvent(self<span style=color:#ff79c6>.</span>hWaitStop)
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">63</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">64</span>    <span style=color:#ff79c6>def</span> <span style=color:#50fa7b>SvcDoRun</span>(self):
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">65</span>        <span style=color:#f1fa8c>&#39;&#39;&#39;
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">66</span><span style=color:#f1fa8c>        Called when the service is asked to start
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">67</span><span style=color:#f1fa8c>        &#39;&#39;&#39;</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">68</span>        self<span style=color:#ff79c6>.</span>start()
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">69</span>        servicemanager<span style=color:#ff79c6>.</span>LogMsg(servicemanager<span style=color:#ff79c6>.</span>EVENTLOG_INFORMATION_TYPE,
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">70</span>                              servicemanager<span style=color:#ff79c6>.</span>PYS_SERVICE_STARTED,
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">71</span>                              (self<span style=color:#ff79c6>.</span>_svc_name_, <span style=color:#f1fa8c>&#39;&#39;</span>))
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">72</span>        self<span style=color:#ff79c6>.</span>main()
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">73</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">74</span>    <span style=color:#ff79c6>def</span> <span style=color:#50fa7b>start</span>(self):
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">75</span>        <span style=color:#f1fa8c>&#39;&#39;&#39;
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">76</span><span style=color:#f1fa8c>        Override to add logic before the start
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">77</span><span style=color:#f1fa8c>        eg. running condition
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">78</span><span style=color:#f1fa8c>        &#39;&#39;&#39;</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">79</span>        <span style=color:#ff79c6>pass</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">80</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">81</span>    <span style=color:#ff79c6>def</span> <span style=color:#50fa7b>stop</span>(self):
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">82</span>        <span style=color:#f1fa8c>&#39;&#39;&#39;
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">83</span><span style=color:#f1fa8c>        Override to add logic before the stop
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">84</span><span style=color:#f1fa8c>        eg. invalidating running condition
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">85</span><span style=color:#f1fa8c>        &#39;&#39;&#39;</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">86</span>        <span style=color:#ff79c6>pass</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">87</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">88</span>    <span style=color:#ff79c6>def</span> <span style=color:#50fa7b>main</span>(self):
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">89</span>        <span style=color:#f1fa8c>&#39;&#39;&#39;
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">90</span><span style=color:#f1fa8c>        Main class to be ovverridden to add logic
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">91</span><span style=color:#f1fa8c>        &#39;&#39;&#39;</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">92</span>        <span style=color:#ff79c6>pass</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">93</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">94</span><span style=color:#6272a4># entry point of the module: copy and paste into the new module</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">95</span><span style=color:#6272a4># ensuring you are calling the &#34;parse_command_line&#34; of the new created class</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">96</span><span style=color:#ff79c6>if</span> __name__ <span style=color:#ff79c6>==</span> <span style=color:#f1fa8c>&#39;__main__&#39;</span>:
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">97</span>    SMWinservice<span style=color:#ff79c6>.</span>parse_command_line()
</code></pre></div><p>Let&rsquo;s examine the class we have just introduced a little.</p><p><em><strong>def SvcDoRun(self)</strong></em>: it&rsquo;s the method that will be called when the service is requested to start.</p><p><em><strong>def SvcStop(self)</strong></em>: it&rsquo;s the method that will be called when the service is requested to stop.</p><p><em><strong>def start(self)</strong></em>: it&rsquo;s a method that you will be asked to override if you need to do something when the service is starting (before started)</p><p><em><strong>def stop(self)</strong></em>: it&rsquo;s the method that you will be asked to override if you need to do something when the service is stopping (before stopped)</p><p><em><strong>def main(self)</strong></em>: it&rsquo;s the method that will contain the logic of your script, usually in a loop that keeps it alive until the service is stopped.</p><p><em><strong>def parse_command_line(cls)</strong></em>: it&rsquo;s the method that handles the command line interface that you can use to install and update your windows service</p><p>Can you see how easy it is with pywin32 to interface with the system to create a Windows Service? The last mention is for the following variables:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span>svc_name <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#34;PythonCornerExample&#34;</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span>svc_display_name <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#34;Python Corner&#39;s Winservice Example&#34;</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span>svc_description <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#34;That&#39;s a great winservice! :)&#34;</span>
</code></pre></div><p>These are just three variables that contain the name of the service, the &ldquo;friendly name&rdquo; that will be used by Windows to display the name on the mmc console and a short description of your service.</p><p>As always, enough talk, let&rsquo;s code something useful!</p><hr><p>Let&rsquo;s pretend that we want to create a Winservice that, when started, creates a random file on our C: drive every 5 seconds.</p><p>What? Do you think it is stupid?
Well, install it on your boss PC, set the destination folder as its user&rsquo;s desktop and you will change your mind. :)</p><p>However, how can you achieve this result? Super easy.</p><ul><li>Subclass the SMWinservice class we have just met.</li><li>On the new class, override the three variables <em><em>svc_name</em></em>, <em><em>svc_display_name</em></em> and <em><em>svc_description</em></em>.</li><li>Override the &ldquo;<em><strong>start</strong></em>&rdquo; method to set the running condition. Setting a boolean variable will be enough for that.</li><li>Override the &ldquo;<em><strong>stop</strong></em>&rdquo; method to invalidate the running condition when the service is requested to be stopped.</li><li>Override the &ldquo;<em><strong>main</strong></em>&rdquo; method to add the logic of creating a random file every 5 seconds</li><li>Add the call at the &ldquo;<em><strong>parse_command_line</strong></em>&rdquo; function to handle the command line interface.</li></ul><p>The result should be something like this:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span style=color:#ff79c6>import</span> time
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span style=color:#ff79c6>import</span> random
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span style=color:#ff79c6>from</span> pathlib <span style=color:#ff79c6>import</span> Path
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span style=color:#ff79c6>from</span> SMWinservice <span style=color:#ff79c6>import</span> SMWinservice
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span style=color:#ff79c6>class</span> <span style=color:#50fa7b>PythonCornerExample</span>(SMWinservice):
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span>    _svc_name_ <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#34;PythonCornerExample&#34;</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span>    _svc_display_name_ <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#34;Python Corner&#39;s Winservice Example&#34;</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span>    _svc_description_ <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#34;That&#39;s a great winservice! :)&#34;</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span>    <span style=color:#ff79c6>def</span> <span style=color:#50fa7b>start</span>(self):
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span>        self<span style=color:#ff79c6>.</span>isrunning <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>True</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span>    <span style=color:#ff79c6>def</span> <span style=color:#50fa7b>stop</span>(self):
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span>        self<span style=color:#ff79c6>.</span>isrunning <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>False</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span>    <span style=color:#ff79c6>def</span> <span style=color:#50fa7b>main</span>(self):
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">18</span>        i <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>0</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">19</span>        <span style=color:#ff79c6>while</span> self<span style=color:#ff79c6>.</span>isrunning:
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">20</span>            random<span style=color:#ff79c6>.</span>seed()
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">21</span>            x <span style=color:#ff79c6>=</span> random<span style=color:#ff79c6>.</span>randint(<span style=color:#bd93f9>1</span>, <span style=color:#bd93f9>1000000</span>)
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">22</span>            Path(<span style=color:#f1fa8c>f</span><span style=color:#f1fa8c>&#39;c:</span><span style=color:#f1fa8c>{</span>x<span style=color:#f1fa8c>}</span><span style=color:#f1fa8c>.txt&#39;</span>)<span style=color:#ff79c6>.</span>touch()
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">23</span>            time<span style=color:#ff79c6>.</span>sleep(<span style=color:#bd93f9>5</span>)
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">24</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">25</span><span style=color:#ff79c6>if</span> __name__ <span style=color:#ff79c6>==</span> <span style=color:#f1fa8c>&#39;__main__&#39;</span>:
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">26</span>    PythonCornerExample<span style=color:#ff79c6>.</span>parse_command_line()
</code></pre></div><p>That&rsquo;s it! Now it&rsquo;s time to install our newly created winservice. Just open a command prompt, navigate to your script directory and install the service with the command:</p><pre><code class=language-console data-lang=console>C:test&gt; python PythonCornerExample.py install
Installing service PythonCornerExample
Service installed
</code></pre><p>In the future, if you want to change the code of your service, just modify it and reinstall the service with</p><pre><code class=language-console data-lang=console>C:test&gt; python PythonCornerExample.py update
Changing service configuration
Service updated
</code></pre><p>Now, open the &ldquo;Services&rdquo; msc snap in</p><pre><code class=language-console data-lang=console>C:test&gt; mmc Services.msc
</code></pre><p>locate your new <strong>PythonCornerExample</strong> winservice, and right click and choose properties. Here you can start your service and configure it at your will.</p><p>Now try to start your service and go to see your C: folder contents.</p><p>Can you see all these files being created to your C: folder? Yeah, that&rsquo;s working!</p><p>But now it&rsquo;s time to stop it! :) You can do it from the previous windows or just by using the command line</p><pre><code class=language-console data-lang=console>C:test&gt; net stop PythonCornerExample

Il servizio Python Corner's Winservice Example sta per essere arrestato.. 
Servizio Python Corner's Winservice Example arrestato.
</code></pre><h2 id=if-something-goes-wrong>If something goes wrong&mldr;</h2><p>There are a couple of known problems that can happen writing Windows Services in Python. If you have successfully installed the service but starting it you get an error, follow this iter to troubleshoot your service:</p><ul><li>Check if Python is in your PATH variable. It MUST be there. To check this, just open a command prompt and try starting the python interpreter by typing &ldquo;python&rdquo;. If it starts, you are ok.</li><li>Be sure to have the file <code>C:\Program Files\Python36\Lib\site-packages\win32\pywintypes36.dll</code> (please note that &ldquo;36&rdquo; is the version of your Python installation). If you don&rsquo;t have this file, take it from <code>C:\Program Files\Python36\Lib\site-packages\pywin32_system32\pywintypes36.dll</code> and copy it into <code>C:\Program Files\Python36\Lib\site-packages\win32</code></li></ul><p>If you still have problems, try executing your Python script in debug mode. To try this with our previous example, open a terminal, navigate to the directory where the script resides and type</p><pre><code class=language-console data-lang=console>c:test&gt; python PythonCornerExample.py debug
</code></pre><hr><p>Ok, that&rsquo;s all for today, this was just a brief introduction to developing Windows Services with Python. Try it by yourself and &mldr; happy coding!</p><p>D.</p></div></article><hr><h2 style=color:#2bbc8a;text-align:center>Did you find this article helpful?</h2><br><style>.bmc-button img{height:34px!important;width:35px!important;margin-bottom:1px!important;box-shadow:none!important;border:none!important;vertical-align:middle!important}.bmc-button{padding:7px 10px!important;line-height:35px!important;height:51px!important;min-width:217px!important;text-decoration:none!important;display:inline-flex!important;color:#fff!important;background-color:#ff813f!important;border-radius:5px!important;border:1px solid transparent!important;padding:7px 10px!important;font-size:22px!important;letter-spacing:.6px!important;box-shadow:0 1px 2px rgba(190,190,190,.5)!important;-webkit-box-shadow:0 1px 2px 2px rgba(190,190,190,.5)!important;margin:0 auto!important;font-family:cookie,cursive!important;-webkit-box-sizing:border-box!important;box-sizing:border-box!important;-o-transition:.3s all linear!important;-webkit-transition:.3s all linear!important;-moz-transition:.3s all linear!important;-ms-transition:.3s all linear!important;transition:.3s all linear!important}.bmc-button:hover,.bmc-button:active,.bmc-button:focus{-webkit-box-shadow:0 1px 2px 2px rgba(190,190,190,.5)!important;text-decoration:none!important;box-shadow:0 1px 2px 2px rgba(190,190,190,.5)!important;opacity:.85!important;color:#fff!important}</style><link href="https://fonts.googleapis.com/css?family=Cookie" rel=stylesheet><a class=bmc-button target=_blank href=https://www.buymeacoffee.com/dXjDHmt style=align:left><img src=https://cdn.buymeacoffee.com/buttons/bmc-new-btn-logo.svg alt="Buy me a coffee!" align=left>
<span style=margin-left:15px;font-size:28px!important>Buy me a coffee!</span></a><hr><div class=blog-post-comments><div id=disquss_thread><script src=https://utteranc.es/client.js repo=mastro35/tpc issue-term=pathname label="The Python Corner" theme=github-dark crossorigin=anonymous async></script></div></div><div id=footer-post-container><div id=footer-post><div id=nav-footer style=display:none><ul><li><a href=../../>Home</a></li><li><a href=../../posts>Articles</a></li><li><a href=../../tags>Tags</a></li><li><a href=../../about>About</a></li><li><a href=../../help_us>Help Us</a></li><li><a href=https://buttondown.email/thepythoncorner>Newsletter</a></li><li><a href=https://shop.spreadshirt.com/the-python-corner>Swag Store</a></li></ul></div><div id=toc-footer style=display:none><nav id=TableOfContents><ul><li><a href=#if-something-goes-wrong>If something goes wrong&mldr;</a></li></ul></nav></div><div id=share-footer style=display:none><ul><li><a class=icon href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fmastro35.github.io%2ftpc%2fposts%2f2018-08-01-how-to-create-a-windows-service-in-python%2f" aria-label=Facebook><i class="fab fa-facebook fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://twitter.com/share?url=https%3a%2f%2fmastro35.github.io%2ftpc%2fposts%2f2018-08-01-how-to-create-a-windows-service-in-python%2f&text=How%20to%20create%20a%20Windows%20Service%20in%20Python" aria-label=Twitter><i class="fab fa-twitter fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fmastro35.github.io%2ftpc%2fposts%2f2018-08-01-how-to-create-a-windows-service-in-python%2f&title=How%20to%20create%20a%20Windows%20Service%20in%20Python" aria-label=Linkedin><i class="fab fa-linkedin fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fmastro35.github.io%2ftpc%2fposts%2f2018-08-01-how-to-create-a-windows-service-in-python%2f&is_video=false&description=How%20to%20create%20a%20Windows%20Service%20in%20Python" aria-label=Pinterest><i class="fab fa-pinterest fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="mailto:?subject=How%20to%20create%20a%20Windows%20Service%20in%20Python&body=Check out this article: https%3a%2f%2fmastro35.github.io%2ftpc%2fposts%2f2018-08-01-how-to-create-a-windows-service-in-python%2f" aria-label=Email><i class="fas fa-envelope fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://getpocket.com/save?url=https%3a%2f%2fmastro35.github.io%2ftpc%2fposts%2f2018-08-01-how-to-create-a-windows-service-in-python%2f&title=How%20to%20create%20a%20Windows%20Service%20in%20Python" aria-label=Pocket><i class="fab fa-get-pocket fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://reddit.com/submit?url=https%3a%2f%2fmastro35.github.io%2ftpc%2fposts%2f2018-08-01-how-to-create-a-windows-service-in-python%2f&title=How%20to%20create%20a%20Windows%20Service%20in%20Python" aria-label=reddit><i class="fab fa-reddit fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://www.tumblr.com/share/link?url=https%3a%2f%2fmastro35.github.io%2ftpc%2fposts%2f2018-08-01-how-to-create-a-windows-service-in-python%2f&name=How%20to%20create%20a%20Windows%20Service%20in%20Python&description=Hi%20guys%2c%20today%26rsquo%3bs%20post%20is%20just%20for%20the%20ones%20of%20you%20that%20work%20with%20the%20%26ldquo%3bOS%20of%20the%20misoriented%20slashes%26rdquo%3b%3a%20Microsoft%20Windows.%20%3a%29%0aHave%20you%20ever%20had%20the%20need%20of%20writing%20a%20Python%20script%20that%20could%20run%20in%20background%20as%20a%20Windows%20Service%3f%20In%20this%20post%2c%20you%20will%20learn%20how%20to%20do%20it%20in%20less%20than%2010%20minutes%2c%20no%20jokes.%0aI%20will%20skip%20all%20the%20introduction%20about%20Windows%20Services%2c%20how%20convenient%20they%20could%20be%2c%20how%20much%20could%20be%20appreciated%20the%20fact%20that%20they%20can%20be%20run%20in%20background%20even%20when%20the%20user%20is%20logged%20off%20etc%26hellip%3b%20I%20mean%2c%20if%20you%20can%20code%20in%20Python%20and%20you%20use%20Windows%20I%20bet%20you%20already%20know%20what%20a%20Windows%20Service%20is%2c%20don%26rsquo%3bt%20you%3f" aria-label=Tumblr><i class="fab fa-tumblr fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fmastro35.github.io%2ftpc%2fposts%2f2018-08-01-how-to-create-a-windows-service-in-python%2f&t=How%20to%20create%20a%20Windows%20Service%20in%20Python" aria-label="Hacker News"><i class="fab fa-hacker-news fa-lg" aria-hidden=true></i></a></li></ul></div><div id=actions-footer><a id=menu-toggle class=icon href=# onclick="return $('#nav-footer').toggle(),!1" aria-label=Menu><i class="fas fa-bars fa-lg" aria-hidden=true></i> Menu</a>
<a id=toc-toggle class=icon href=# onclick="return $('#toc-footer').toggle(),!1" aria-label=TOC><i class="fas fa-list fa-lg" aria-hidden=true></i> TOC</a>
<a id=share-toggle class=icon href=# onclick="return $('#share-footer').toggle(),!1" aria-label=Share><i class="fas fa-share-alt fa-lg" aria-hidden=true></i> share</a>
<a id=top style=display:none class=icon href=# onclick="$('html, body').animate({scrollTop:0},'fast')" aria-label="Top of Page"><i class="fas fa-chevron-up fa-lg" aria-hidden=true></i> Top</a></div></div></div><footer id=footer><div class=footer-left>Copyright &copy; 2021 Davide Mastromatteo</div><div class=footer-right><nav><ul><li><a href=../../>Home</a></li><li><a href=../../posts>Articles</a></li><li><a href=../../tags>Tags</a></li><li><a href=../../about>About</a></li><li><a href=../../help_us>Help Us</a></li><li><a href=https://buttondown.email/thepythoncorner>Newsletter</a></li><li><a href=https://shop.spreadshirt.com/the-python-corner>Swag Store</a></li></ul></nav></div></footer></div></body><link rel=stylesheet href=../../lib/font-awesome/css/all.min.css><script src=../../lib/jquery/jquery.min.js></script><script src=../../js/main.js></script><script src=../../js/code-copy.js></script></html>